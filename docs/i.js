let t,s,i;s=.3,t=(t=1,s=.05,h=220,e=0,n=0,r=.1,o=0,a=1,c=0,u=0,l=0,d=0,f=0,w=0,p=0,m=0,g=0,y=1,E=0,x=0,M=Math,A=44100,_=2*M.PI,k=(c*=500*_/A/A),T=(h*=(1-s+2*s*M.random(s=[]))*_/A),I=0,b=0,F=0,D=1,S=0,v=0,K=0,H,L)=>{for(u*=500*_/A**3,p*=_/A,l*=_/A,d*=A,f=A*f|0,L=(e=A*e+9)+(E*=A)+(n*=A)+(r*=A)+(g*=A)|0;F<L;s[F++]=K)++v%(100*m|0)||(K=o?1<o?2<o?3<o?M.sin((I%_)**3):M.max(M.min(M.tan(I),1),-1):1-(2*I/_%2+2)%2:1-4*M.abs(M.round(I/_)-I/_):M.sin(I),K=(f?1-x+x*M.sin(_*F/f):1)*(0<K?1:-1)*M.abs(K)**a*.3*t*(F<e?F/e:F<e+E?1-(F-e)/E*(1-y):F<e+E+n?y:F<L-g?(L-F-g)/r*y:0),K=g?K/2+(g>F?0:(F<L-g?1:(L-F)/g)*s[F-g|0]/2):K),I+=(H=(h+=c+=u)*M.cos(p*b++))-H*w*(1-1e9*(M.sin(F)+1)%2),D&&++D>d&&(h+=l,T+=l,D=0),!f||++S%f||(h=T,c=k,D||=1);return(t=i.createBuffer(1,L,A)).getChannelData(0).set(s),(h=i.createBufferSource()).buffer=t,h.connect(i.destination),h.start(),h},i=new AudioContext;const h={t:!0,i:"Arial, sans-serif",h:60,o:96,u:48,l:1,p:2,init(){h.m.init(),h.Audio.init(),h.g.init((()=>{h.g.level=new h.A.M,h.g._()}))},k(t,s){let i=Math.min(t.x+t.w,s.x+s.w)-Math.max(t.x,s.x);i=i<0?0:i;let h=Math.min(t.y+t.T,s.y+s.T)-Math.max(t.y,s.y);return h=h<0?0:h,i*h>Number.EPSILON}};window.addEventListener("load",(()=>h.init())),h.I=class{constructor(t=0,s=0){this.x=t,this.y=s}clone(){return new h.I(this.x,this.y)}length(){return this.x+this.y===0?0:Math.sqrt(this.x*this.x+this.y*this.y)}mul(t){return this.x*=t,this.y*=t,this}normalize(){const t=this.length();return t&&(this.x/=t,this.y/=t),this}set(t,s){this.x=t,this.y=s}},h.Audio={F:{},D:.2,S:{v:(t,s,i)=>(s[t]=2*Math.random()-1,i[t]=2*Math.random()-1,!1)},init(){this.K=new window.AudioContext,this.gain=this.K.createGain(),this.gain.connect(this.K.destination),this.volume(.1);for(const t in this.S){const s=2*this.K.sampleRate,i=this.K.createBuffer(2,s,this.K.sampleRate),h=i.getChannelData(0),e=i.getChannelData(1);for(let i=0;i<s&&!this.S[t](i,h,e);i++);this.F[t]=i}},H(){0!==this.gain.gain.value&&(this.D=this.gain.gain.value,this.gain.gain.value=0)},play(t,s,i=1,h="dec"){const e=this.K.createGain();e.connect(this.gain),"inc"===h?(e.gain.setValueAtTime(0,this.K.currentTime),e.gain.linearRampToValueAtTime(i,this.K.currentTime+s-.01)):(e.gain.setValueAtTime(i,this.K.currentTime),e.gain.linearRampToValueAtTime(0,this.K.currentTime+s-.01));const n=this.F[t.name],r=this.K.createBufferSource();return r.buffer=n,r.connect(e),r.start(0,0,s),r},L(t,s,i="sine",h="dec"){const e=this.K.createGain();e.connect(this.gain),"inc"===h?(e.gain.setValueAtTime(0,this.K.currentTime),e.gain.linearRampToValueAtTime(1,this.K.currentTime+s-.01)):(e.gain.setValueAtTime(1,this.K.currentTime),e.gain.linearRampToValueAtTime(0,this.K.currentTime+s-.01));const n=this.K.createOscillator();return n.type=i,n.frequency.setValueAtTime(t,this.K.currentTime),n.connect(e),n.start(),n.stop(this.K.currentTime+s),n},N(){this.gain.gain.value=this.D},volume(t){this.gain.gain.value=Math.min(1,Math.max(0,t))}},h.m={C:{O:1,P:2,U:3,R:4,G:5,B:10,W:11,V:12,Z:13,q:14,X:15},Y:{},j:{},J:{click:[],$:[],tt:[]},st:{},it:{},ht:{},et:{},nt:new h.I,rt:0,ot(){this.ct={[this.C.O]:{keyboard:["Escape"],gamepad:[9]},[this.C.W]:{keyboard:["ArrowUp","KeyW","KeyZ","KeyY"],gamepad:[12]},[this.C.B]:{keyboard:["ArrowLeft","KeyA","KeyQ"],gamepad:[14]},[this.C.Z]:{keyboard:["ArrowDown","KeyS"],gamepad:[13]},[this.C.V]:{keyboard:["ArrowRight","KeyD"],gamepad:[15]},[this.C.R]:{keyboard:["Space","Enter"],gamepad:[0]},[this.C.P]:{keyboard:["Enter"],gamepad:[0]},[this.C.G]:{keyboard:["KeyE"],gamepad:[0]}}},ut(){let t=0,s=0;if(this.lt(this.C.B)?t=-1:this.lt(this.C.V)&&(t=1),this.lt(this.C.W)?s=-1:this.lt(this.C.Z)&&(s=1),!t||!s){const i=.3;for(const h in this.ht){const e=this.ht[h];e.axes[0]&&Math.abs(e.axes[0])>i?t=e.axes[0]>0?1:-1:e.axes[2]&&Math.abs(e.axes[2])>i&&(t=e.axes[2]>0?1:-1),e.axes[1]&&Math.abs(e.axes[1])>i?s=e.axes[1]>0?1:-1:e.axes[3]&&Math.abs(e.axes[3])>i&&(s=e.axes[3]>0?1:-1)}}return{x:t,y:s}},dt(t){return this.ct[t]},init(){this.ot(),this.ft()},lt(t,s){const i=this.dt(t);for(const t of i.keyboard)if(this.wt(t,s))return!0;for(const t of i.gamepad)if(this.gt(t,s))return!0;if(t===this.C.B)for(const t in this.ht){const i=this.ht[t];if(i.axes[6]&&i.axes[6]<=-.2)return!this.j["yt"]&&(s&&(this.j["yt"]=!0),!0)}else if(t===this.C.V)for(const t in this.ht){const i=this.ht[t];if(i.axes[6]&&i.axes[6]>=.2)return!this.j["Et"]&&(s&&(this.j["Et"]=!0),!0)}else if(t===this.C.W)for(const t in this.ht){const i=this.ht[t];if(i.axes[7]&&i.axes[7]<=-.2)return!this.j["xt"]&&(s&&(this.j["xt"]=!0),!0)}else if(t===this.C.Z)for(const t in this.ht){const i=this.ht[t];if(i.axes[7]&&i.axes[7]>=.2)return!this.j["Mt"]&&(s&&(this.j["Mt"]=!0),!0)}return!1},gt(t,s){for(const i in this.ht){const h=this.ht[i].buttons[t];if(h&&h.pressed)return!this.j[t]&&(s&&(this.j[t]=!0),!0)}return!1},wt(t,s){const i=this.et[t];return!(!i||!i.time)&&(s&&(i.time=0,i.At=!0),!0)},_t(t,s){if("function"!=typeof s)return void(this.J[t]=[]);const i=this.J[t].indexOf(s);i>=0&&this.J[t].splice(i,1)},kt(t,s){this.J[t].push(s)},Tt(t,s){const i=this.st[t]||[];i.push(s),this.st[t]=i},It(t,s){const i=this.it[t]||[];i.push(s),this.it[t]=i},ft(){document.body.onkeydown=t=>{const s=this.et[t.code];s&&s.At||(this.et[t.code]={time:Date.now()},this.st[t.code]&&this.st[t.code].forEach((t=>t())))},document.body.onkeyup=t=>{this.et[t.code]={time:0},this.it[t.code]&&this.it[t.code].forEach((t=>t()))},document.body.onmousemove=t=>{this.nt.x=t.clientX,this.nt.y=t.clientY},document.body.onclick=t=>{this.J.click.forEach((t=>t(this.nt.clone())))},window.addEventListener("gamepadconnected",(t=>{this.rt++,this.ht[t.gamepad.index]=t.gamepad,this.J.$.forEach((t=>t()))})),window.addEventListener("gamepaddisconnected",(t=>{this.rt--,delete this.ht[t.gamepad.index],this.J.tt.forEach((t=>t()))}))},update(){const t=navigator.getGamepads();for(const s of t)if(s){this.ht[s.index]=s;for(const t in this.j)"axis6-"===t||"axis6+"===t?s.axes[6]||delete this.j[t]:"axis7-"===t||"axis7+"===t?s.axes[7]||delete this.j[t]:s.buttons[t]&&!s.buttons[t].pressed&&delete this.j[t]}}},h.g={bt:new h.I,scale:1,Ft:0,Dt:0,St(t){const[s,i]=this.vt(t.width,t.height);i.drawImage(t,0,0);const h=i.getImageData(0,0,t.width,t.height);for(let s=0;s<t.height;s++)for(let i=0;i<t.width;i++){const e=4*(s*t.width+i);0!==h.data[e+3]&&(h.data[e+0]=255,h.data[e+1]=255,h.data[e+2]=255)}return i.putImageData(h,0,0),s},Kt(t){const s=t.Ht();this.Ft=(this.bt.x-s.x)*this.scale,this.Dt=(this.bt.y-s.y)*this.scale},clear(){this.K.setTransform(1,0,0,1,0,0),this.K.clearRect(0,0,window.innerWidth,window.innerHeight),this.Lt.setTransform(1,0,0,1,0,0),this.Lt.clearRect(0,0,window.innerWidth,window.innerHeight)},Nt(){this.clear(),this.K.setTransform(this.scale,0,0,this.scale,this.Ft,this.Dt),this.Lt.setTransform(this.scale,0,0,this.scale,0,0),this.level&&this.level.Nt()},Ct(){this.Lt.setTransform(1,0,0,1,0,0),this.Lt.clearRect(0,0,window.innerWidth,window.innerHeight),this.Lt.setTransform(this.scale,0,0,this.scale,0,0),this.Lt.fillStyle="rgba(0,0,0,0.4)",this.Lt.fillRect(0,0,this.Ot.width/this.scale,this.Ot.height/this.scale),this.Lt.fillStyle="#FFF",this.Lt.font="normal 56px "+h.i,this.Lt.textAlign="center",this.Lt.textBaseline="top",this.Lt.fillText("PAUSED",this.bt.x,this.bt.y-56)},Pt(){this.K.fillRect(-this.Ft/this.scale,-this.Dt/this.scale,this.Ut.width/this.scale,this.Ut.height/this.scale)},vt(t,s){const i=document.createElement("canvas");i.width=t,i.height=s;const h=i.getContext("2d",{alpha:!0});return h.imageSmoothingEnabled=!1,[i,h]},init(t){this.Ut=document.getElementById("c"),this.K=this.Ut.getContext("2d",{alpha:!0}),this.K.imageSmoothingEnabled=!1,this.Ot=document.getElementById("ui"),this.Lt=this.Ot.getContext("2d",{alpha:!0}),this.Lt.imageSmoothingEnabled=!1,this.Rt((()=>{this.ft(),t()}))},Rt(t){const s=new Image;s.onload=()=>{this.images=s,this.Gt=this.St(s);const[i,e]=this.vt(h.o,h.o);e.drawImage(this.images,16,0,16,16,0,0,h.o,h.o),this.zt=e.createPattern(i,"repeat"),t()},s.src="i.png"},_(t=0){if(h.m.update(),t&&this.Bt){const s=(t-this.Bt)/(1e3/h.h);if(this.K.imageSmoothingEnabled=!1,this.Lt.imageSmoothingEnabled=!1,this.K.lineWidth=1,this.K.textBaseline="alphabetic",this.Wt)return void this.Ct();this.level.update(s),this.Nt(),h.t&&(this.Lt.fillStyle="#000",this.Lt.fillRect(60,this.Ut.height/this.scale-74,140,28),this.Lt.fillStyle="#FFF",this.Lt.font="16px monospace",this.Lt.textAlign="right",this.Lt.textBaseline="bottom",this.Lt.fillText(~~(h.h/s)+" FPS, "+Math.round(100*this.scale)/100,192,this.Ut.height/this.scale-50))}this.Bt=t,requestAnimationFrame((t=>this._(t)))},pause(){this.Wt=!0,h.Audio.H()},ft(){window.addEventListener("resize",(t=>this.resize())),this.resize();const t=h.m.dt(h.m.C.O);setInterval((()=>{this.Wt&&h.m.update(),t.gamepad.forEach((t=>{h.m.gt(t,!0)&&this.Vt()}))}),100);const s=()=>this.Vt();t.keyboard.forEach((t=>h.m.It(t,s))),h.m.kt("gp_disconnect",(()=>this.pause()))},Zt(){this.level=new this.level.constructor},resetTransform(){this.K.setTransform(this.scale,0,0,this.scale,this.Ft,this.Dt)},resize(){const t=1920/1080;let s=window.innerHeight,i=Math.round(s*t);i>window.innerWidth&&(i=window.innerWidth,s=i/t),this.scale=s/1080,this.bt.x=i/2/this.scale,this.bt.y=s/2/this.scale;let h=~~((window.innerHeight-s)/2)+"px",e=~~((window.innerWidth-i)/2)+"px";this.Ut.width=i,this.Ut.height=s,this.Ut.style.top=h,this.Ut.style.left=e,this.Ot.width=i,this.Ot.height=s,this.Ot.style.top=h,this.Ot.style.left=e,this.Wt&&(clearTimeout(this.qt),this.qt=setTimeout((()=>this.Ct()),100))},Xt(t,s,i){t.translate(i.x,i.y),t.rotate(s),t.translate(-i.x,-i.y)},Yt(t,s,i,h){t.translate(h.x,h.y),t.scale(s,i),t.translate(-h.x,-h.y)},Vt(){this.Wt?this.unpause():this.pause()},unpause(){this.Wt&&(this.Wt=!1,h.Audio.N(),this._())}},h.jt=class{constructor(t,s=0){this.level=t,this.set(s)}Qt(){return this.level.Jt>this.timeEnd}$t(){return Math.min(1,1-(this.timeEnd-this.level.Jt)/this.duration)}set(t){this.duration=t*h.h,this.timeEnd=this.level.Jt+this.duration}},h.A=class{constructor(){this.ts=!1,this.ss={},this.Jt=0,this.hs=[],this.es=[],this.items=[],this.ns={p1:null,p2:null}}rs(...t){this.es.push(...t),this.os(...t)}cs(...t){this.items.push(...t),this.os(...t)}os(...t){t.forEach((t=>t.level=this)),this.hs.push(...t)}removeItem(t){let s=this.items.indexOf(t);s>=0&&this.items.splice(s,1),s=this.hs.indexOf(t),s>=0&&this.hs.splice(s,1)}Nt(){this.ts?this.us(h.g.K):(this.ls(h.g.K),this.hs.forEach((t=>t.Nt(h.g.K))),this.ds(h.g.K))}ds(){}us(t){const s=h.g.bt;t.font="bold 36px "+h.i,t.textAlign="center",t.fillStyle="#DDD",t.fillText("GAME OVER",s.x,s.y)}update(t){if(this.Jt+=t,this.ts)h.m.lt(h.m.C.P,!0)&&h.g.Zt();else{const s=this.ns.p1;if(s){h.g.Kt(s),h.m.lt(h.m.C.R,!0)&&s.attack();let i=h.m.ut();i=new h.I(i.x,i.y),s.update(t,i.normalize());const e=s.fs();this.items.forEach((t=>{t.ws=!1,t.ps&&h.k(t.fs(),e)&&(t.ws=!0,h.m.lt(h.m.C.G,!0)&&s.gs(t))}))}this.hs.sort(((t,s)=>t.ys()-s.ys())),this.hs.forEach((i=>{i!==s&&(i.update(t),s?.Es&&(!i.xs||i.xs.Qt())&&i.Ms>0&&s.item.As(i)&&i._s(s.item),i.action)}))}}},h.ks=class{constructor(t={}){this.Ts=new h.I(t.x,t.y),this.w=t.w||0,this.T=t.T||0,this.Is=0,this.xs=null,this.bs={},this.ps=!1,this.Fs=[],this.Ds=new h.I(1,0),this.Ss=1/0,this.Ms=1/0,this.ws=!1,this.level=null,this.speed=new h.I,this.state=h.l}vs(t){for(let s=this.Fs.length-1;s>=0;s--){(0,this.Fs[s])(t)&&this.Fs.splice(s,1)}}Nt(t){}fs(){return{x:this.Ts.x,y:this.Ts.y,w:this.w,T:this.T}}Ht(){return{x:this.Ts.x+this.w/2,y:this.Ts.y+this.T/2}}Ks(t,s,i){return this.bs.Hs||(this.Ts.x+=Math.round(s*t.x*this.speed.x),this.Ts.y+=Math.round(s*t.y*this.speed.y),(t.x||t.y)&&(i=h.p,this.Ds.set(0==t.x?this.Ds.x:t.x>0?1:-1,0==t.y?this.Ds.y:t.y>0?1:-1))),i}ys(){return this.Ts.y+this.T}_s(t){this.xs=this.xs||new h.jt(this.level),this.xs.set(.5),this.Ms=Math.max(0,this.Ms-t.Ls);const s=t.Ns(this);s&&this.Fs.push(s),this.Ms<=0&&this.Cs()}update(t,s){if(this.Ms<=0||this.Os)return;let i=h.l;this.Is+=t,this.vs(t),s&&(i=this.Ks(s,t,i)),this.state!=i&&(this.Is=0),this.state=i}},h.Ps=class extends h.ks{constructor(t={}){t.w=h.o,t.T=h.o,super(t),this.Us=42/h.h,this.action=null,this.Rs=null,this.Es=!1,this.Ss=100,this.Ms=100,this.item=t.item,this.speed.set(12,12),this.item&&(this.item.Os=this)}Gs(t,s){h.g.Yt(t,s,1,this.Ht())}zs(t){h.g.Xt(t,.1*Math.sin(this.Is*this.Us),this.Ht())}Bs(t){if(this.Ms==this.Ss)return;let s=this.Ms/this.Ss,i=this.Ts.x+16,h=this.Ts.y-24,e=this.w-32;t.fillStyle="#000",t.fillRect(i,h,e,8),t.fillStyle="#f00",t.fillRect(i,h,e*s,8)}Ws(t,s){const i=this.Ds.x<0;i&&this.Gs(t,-1),this.item?.Nt(t,s),i&&this.Gs(t,-1)}attack(){!this.Es&&this.item&&(this.Rs=this.Rs||new h.jt(this.level),this.Rs.set(this.item.Vs),this.Es=!0)}Nt(t){if(this.Ms<=0)return;let s=this.Zs+(this.Ds.x<0?16:0),i=h.g.images;if(this.xs&&!this.xs.Qt()){const t=this.xs.$t();(t>=0&&t<=.2||t>=.4&&t<=.6||t>=.8&&t<=1)&&(i=h.g.Gt)}this.state===h.p&&this.zs(t),this.item&&this.Ws(t,i),this.Bs(t),t.drawImage(i,s,this.qs,this.Xs,this.Ys,this.Ts.x,this.Ts.y,h.o,h.o),h.g.resetTransform()}Cs(){this.item?.js(),this.Ms>0&&(this.item=new h.Qs,this.item.Os=this)}fs(){const t={x:this.Ts.x,y:this.Ts.y+this.T,w:this.w,T:h.u/2};return t.y-=t.T,t}gs(t){this.item?.js(),this.item=t,t.ws=!1,t.Os=this,this.level.removeItem(t)}update(t,s){if(this.Ms<=0)return;let i=h.l;this.Is+=t,this.vs(t),s&&(i=this.Ks(s,t,i)),this.action&&(i=this.action(t)||i),this.state!=i&&(this.Is=0),this.Es&&this.Rs.Qt()&&(this.Es=!1),this.level&&(this.Ts.x=Math.min(this.level.ss.x+this.level.ss.w-this.w,Math.max(this.level.ss.x,this.Ts.x)),this.Ts.y=Math.min(this.level.ss.y+this.level.ss.T-this.T-8,Math.max(this.level.ss.y-h.u,this.Ts.y))),this.state=i}},h.Js={$s(t,s){if(t.Es||!t.item)return!1;if(t.item.As(s)){const i=new h.jt(t.level,.3);return t.action=function(){i.Qt()&&(t.Es&&t.Rs&&t.Rs.Qt()?t.action=null:t.Es||(t.attack(),s._s(t.item)))},!0}return!1},ti(t){if(t.item&&!(t.item instanceof h.Qs))return!1;let s=1/0,i=null,e=null;const n=t.Ht(),r=t.fs(),o=new h.I;for(let a=0;a<t.level.items.length;a++){const c=t.level.items[a];if(c instanceof h.si){const a=c.fs();if(h.k(a,r)){const s=new h.jt(t.level,.5);return t.action=function(){s.Qt()&&(t.gs(c),t.action=null)},!0}o.set(a.x+a.w/2-n.x,a.y+a.T/2-n.y);const u=o.length();u<3*h.o&&s>u&&(s=u,i=o.clone(),e=c)}}if(!e)return!1;const a=new h.jt(t.level,1);return i.normalize(),t.action=function(s){if(a.Qt())t.action=null;else if(!t.bs.Hs)return t.Ks(i,s,0)},!0},ii(t,s){const i=t.Ht(),e=s.Ht(),n=new h.I(e.x-i.x,e.y-i.y);if(n.length()>4*h.o)return!1;const r=new h.jt(t.level,1);return n.normalize(),t.action=function(s){if(r.Qt())t.action=null;else if(!t.bs.Hs)return t.Ks(n,s,0)},!0},hi(t,s){!s||t.bs.Hs||s.Ms<=0||this.ti(t)||this.$s(t,s)||this.ii(t,s)}},h.si=class extends h.ks{constructor(t){super(t),this.Os=null}ei(t){const s=this.fs();t.strokeStyle="#f00",t.lineWidth=2,t.strokeRect(s.x,s.y,s.w,s.T)}ni(){this.Ts.set(this.Os.Ts.x+this.Os.w/2,this.Os.Ts.y-this.Os.T)}js(){this.ps&&(this.ni(),this.Os.level.cs(this)),this.Os=null}Ns(){return null}ys(){return this.Ts.y}},h.ri=class extends h.Ps{constructor(t){super(t),this.Zs=0,this.qs=32,this.Xs=16,this.Ys=16,this.Us=32/h.h,this.speed.set(3,3)}_s(t){this.Ms<=0||super._s(t)}},h.oi=class extends h.Ps{constructor(t){super(t),this.Zs=0,this.qs=16,this.Xs=16,this.Ys=16}},h.Qs=class extends h.si{constructor(t={}){super(t),this.Vs=.15,this.Ls=10}As(t){const s={x:this.Os.Ts.x+this.Os.w,y:this.Os.Ts.y+h.u/2,w:h.u,T:h.u};this.Os.Ds.x<0&&(s.x-=this.Os.w+s.w);const i={x:t.Ts.x,y:t.Ts.y,w:t.w,T:t.T};return h.k(i,s)}Nt(t,s){let i=this.Ts.x,e=this.Ts.y;if(this.Os&&(i=this.Os.Ts.x+this.Os.w-32,e=this.Os.Ts.y+this.Os.T/2-16),this.Os.Es){const t=Math.sin(this.Os.Rs.$t()*Math.PI*2)*h.u;i+=Math.max(0,t)}t.drawImage(s||h.g.images,40,16,8,8,i,e,h.u,h.u)}Ns(t){if(t instanceof h.Ps)return function(){return t.Cs(),!0}}},h.ai=class extends h.si{constructor(t={}){t.w=h.u,t.T=2*h.o,super(t),this.Vs=.25,this.ps=!0,this.Ls=34}ni(){this.Os&&this.Ts.set(this.Os.Ts.x+this.Os.w/2,this.Os.Ts.y-this.Os.T+this.T/2)}As(t){const s=[{x:this.Os.Ts.x+this.Os.w,y:this.Os.Ts.y,w:1.7*h.o,T:h.o},{x:this.Os.Ts.x+this.Os.w,y:this.Os.Ts.y-.7*h.o,w:h.o,T:2.4*h.o}];this.Os.Ds.x<0&&(s[0].x-=this.Os.w+s[0].w,s[1].x-=this.Os.w+s[1].w);const i={x:t.Ts.x,y:t.Ts.y,w:t.w,T:t.T};for(let t=0;t<s.length;t++)if(h.k(i,s[t]))return!0;return!1}Nt(t,s){let i=this.Ts.x,e=this.Ts.y;this.Os&&(i=this.Os.Ts.x+h.u,e=this.Os.Ts.y-h.o-16);let n=0,r={x:i+this.w/2,y:e+this.T/2};if(this.Os){if(this.Os?.Es){r.x=i+h.o/4,r.y=e+2*h.o;let t=this.Os.Rs.$t();const s=Math.PI;t<=.4?(t/=.4,n=t*s):n=t<=.8?s:0}}else n=80*Math.PI/180;n&&h.g.Xt(t,n,r),t.drawImage(s||h.g.images,32,16,8,32,i,e,h.u,2*h.o),n&&this.Os?.Es&&h.g.Xt(t,-n,r),this.Os||(h.g.resetTransform(),this.ws&&this.ei(t))}Ns(t){if(!(t instanceof h.Ps))return;const s=t.Ts.clone(),i=this.Os.Ht(),e=t.Ht(),n=new h.I(e.x-i.x,e.y-i.y);n.normalize();const r=new h.jt(this.Os.level,.3),o=1.5*h.o;return t.bs.Hs=!0,function(){if(r.Qt())return t.bs.Hs=!1,!0;const i=r.$t();return t.Ts.set(s.x+n.x*o*i,s.y+n.y*o*i),!1}}fs(){return{x:this.Ts.x-1.5*this.w,y:this.Ts.y+1.5*this.w,w:this.T,T:this.w}}},h.A.M=class extends h.A{constructor(){super(),this.ci=0,this.ui=2,this.li="Ez enwas niht anders / wan gestéinẹ unde golt. / unt ob man al die werlde / het dâ von versolt, / sîn wǽré niht mínner / einer marke wert.",this.di="Ê daz der künee rîche / wider wære komen, / die wîle hete Hagene / den schaz vil gar genomen. / er sanctẹ in dâ ze Lôche / allen in den Rîn. / er wandẹ er soldẹ in niezen: / des enkunde niht gesîn."}fi(t,s,i,e,n){if(n){let s=h.u/2,n=h.o,r=i-96,o=e-n/2,a={x:r+s/2,y:o+n/2};h.g.Xt(t,Math.PI/2,a),h.g.Yt(t,Math.sin(.08*this.Jt),1,a),t.drawImage(h.g.images,32,16,8,32,r,o,s,n),h.g.resetTransform()}t.fillStyle=n?"#fa0":"#777",t.textBaseline="middle",t.fillText(s,i,e)}Nt(){const t=h.g.K;let s=Math.max(2*h.o,h.g.bt.x-500),i=Math.max(2*h.o,h.g.bt.y-128);t.fillStyle="#0d161e",h.g.Pt(),t.font="bold 64px "+h.i,t.textAlign="left",t.fillStyle="#fa0",t.fillText("TREASURE OF THE NIBELUNGS",s,i+3),t.fillStyle="#777",t.fillText("TREASURE OF THE NIBELUNGS",s,i),t.font="42px "+h.i,s+=h.u/2+114,i+=96,this.fi(t,"New Game",s,i,0===this.ci),i+=72,this.fi(t,"Continue",s,i,1===this.ci)}update(t){this.Jt+=t,h.m.lt(h.m.C.W,!0)?this.ci--:h.m.lt(h.m.C.Z,!0)?this.ci++:h.m.lt(h.m.C.P,!0)&&0===this.ci&&(h.g.level=new h.A.wi),this.ci<0?this.ci=this.ui-1:this.ci>=this.ui&&(this.ci=0)}},h.A.wi=class extends h.A{constructor(){super(),this.ss={x:0,y:0,w:16*h.o,T:8*h.o};const t=new h.oi({x:300,y:400,item:new h.Qs}),s=new h.ri({x:600,y:400,item:new h.ai});s.Ds.x=-1,this.rs(t,s);const i=new h.ai({x:400,y:540});this.cs(i),this.ns.p1=t}ls(t){const s=h.g;t.fillStyle=s.zt,h.g.Pt(),this.pi&&t.drawImage(this.pi,-h.o/16,-h.o),t.fillStyle="#5a3c2e",t.strokeStyle="#8f563b",t.lineWidth=h.o/16;let i=t.lineWidth/2;t.strokeRect(-i,-i,this.ss.w+t.lineWidth,this.ss.T),t.fillRect(-t.lineWidth,this.ss.T,this.ss.w+2*t.lineWidth,h.o);for(let i=0;i<16;i++)for(let e=0;e<8;e++){let n=i*h.o,r=e*h.o;t.drawImage(s.images,0,0,16,16,n,r,h.o,h.o)}}ds(t){const s=h.o/16;for(let s=0;s<11;s++)t.drawImage(h.g.images,32,0,16,16,s*h.o*1.5,this.ss.T,h.o,h.o);if(this.pi)t.drawImage(this.pi,-s,this.ss.T-1.5*h.u);else{const t=3*s+this.ss.w,i=h.o,[e,n]=h.g.vt(t,i);n.fillStyle="#5a3c2e",n.lineWidth=s,n.fillRect(0,0,this.ss.w+2*n.lineWidth,10);const r=(this.ss.w+2*n.lineWidth)/h.o;for(let t=0;t<=r;t++)n.fillRect(t*h.o,0,12,h.o);this.pi=e}}};